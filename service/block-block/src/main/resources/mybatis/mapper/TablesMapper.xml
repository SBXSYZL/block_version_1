<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.project.demo.dao.TablesMapper">
    <select id="selectTables" resultType="java.lang.String">
        select table_name as tableName
        from information_schema.tables
        where table_schema='block'
        and table_type='base table'
        <if test="prefix != null and prefix != ''">
            and locate(#{prefix,jdbcType=VARCHAR},table_name)>0;
        </if>

    </select>
    <select id="selectLastTable" resultType="java.lang.String">
        select table_name
        from information_schema.tables
        where table_schema='block'
        and table_type='base table'
        and locate(#{prefix,jdbcType=VARCHAR},table_name)>0
        limit 1;

    </select>
</mapper>